#include <stdio.h>

int N, type, per[20], ans[20];
long long k, order = 1;
long long fac[21];
bool used[21] = { false, };


int main() {
	scanf("%d", &N);
	scanf("%d", &type);

	fac[0] = 1;
	fac[1] = 1;
	for (int i = 2; i <= 20; i++) {
		fac[i] = fac[i - 1] * i;
	}

	if (type == 1) {
		scanf("%lld", &k);
		int remained = N, idx=0;
		long long temp;
		for (int i = 1; i <= N; i++) {
			if (used[i]) continue;
			if (k == 0) break;
			temp = fac[remained - 1];
			if (temp < k) k -= temp;
			else {
				ans[idx++] = i;
				used[i] = true;
				remained--;
				i = 0;
			}
		}

		for (int i = 1; i <= N; i++) {
			if (used[i] == false)
				ans[idx++] = i;
		}

		for (int i = 0; i < N; i++)
			printf("%d ", ans[i]);
	}
	else {
		for (int i = 0; i < N; i++)
			scanf("%d", &per[i]);

		for (int i = 0; i < N; i++) {
			for (int j = 1; j < per[i]; j++) {
				if (used[j]) continue;
				order += fac[N - i - 1];
			}
			used[per[i]] = true;
		}
		printf("%lld", order);
	}
	return 0;
}
